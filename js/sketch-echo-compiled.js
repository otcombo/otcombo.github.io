p5.disableFriendlyErrors=!0;var play_it=1,first_time=1,amount=800,radius_scale=2.5,rotate_speed=5E-6,X=Array(amount+1),Y=Array(amount+1),Z=Array(amount+1),VX=Array(amount+1),VY=Array(amount+1),VZ=Array(amount+1),dVX=Array(amount+1),dVY=Array(amount+1),dVZ=Array(amount+1),M=1E3,L,R,N,NN,KX,KY,KZ,KVX,KVY,KVZ,KdVX,KdVY,KdVZ;
function setup(){var a=select("#sketch");a=createCanvas(a.width,a.height);a.parent("sketch");a.mouseOver(checkState);a.mouseOut(checkState);1200>width?(radius_scale=2,strokeWeight(8)):(radius_scale=2.5,strokeWeight(10));noFill();R=2*sqrt(16E4*PI/amount/(2*sqrt(3)));for(N=0;N<=amount;N++)X[N]=random(-320,320),Y[N]=random(-320,320),Z[N]=random(-320,320),VX[N]=0,VY[N]=0,VZ[N]=0,dVX[N]=0,dVY[N]=0,dVZ[N]=0,250<Z[N]&&(L=sqrt(X[N]*X[N]+Y[N]*Y[N]),dVX[N]=Y[N]/L,dVY[N]=-1*X[N]/L)}
function draw(){translate(.2*width,.3*height);background(220,33,7,200);if(mouseIsPressed)for(N=0;N<=amount;N++)190<Z[N]&&(L=sqrt(X[N]*X[N]+Y[N]*Y[N]),dVX[N]+=Y[N]/L/10,dVY[N]-=X[N]/L/10);for(N=0;N<=amount;N++){for(NN=N+1;NN<=amount;NN++)L=sqrt((X[N]-X[NN])*(X[N]-X[NN])+(Y[N]-Y[NN])*(Y[N]-Y[NN])),L=sqrt((Z[N]-Z[NN])*(Z[N]-Z[NN])+L*L),L<R&&(X[N]-=(R-L)/(2*L)*(X[NN]-X[N]),Y[N]-=(R-L)/(2*L)*(Y[NN]-Y[N]),Z[N]-=(R-L)/(2*L)*(Z[NN]-Z[N]),X[NN]+=(R-L)/(2*L)*(X[NN]-X[N]),Y[NN]+=(R-L)/(2*L)*(Y[NN]-Y[N]),Z[NN]+=
(R-L)/(2*L)*(Z[NN]-Z[N]),dVX[N]+=(VX[NN]-VX[N])/M,dVY[N]+=(VY[NN]-VY[N])/M,dVZ[N]+=(VZ[NN]-VZ[N])/M,dVZ[NN]-=(VZ[NN]-VZ[N])/M,dVX[NN]-=(VX[NN]-VX[N])/M,dVY[NN]-=(VY[NN]-VY[N])/M),Z[N]>Z[NN]&&(KX=X[N],KY=Y[N],KZ=Z[N],KVX=VX[N],KVY=VY[N],KVZ=VZ[N],KdVX=dVX[N],KdVY=dVY[N],KdVZ=dVZ[N],X[N]=X[NN],Y[N]=Y[NN],Z[N]=Z[NN],VX[N]=VX[NN],VY[N]=VY[NN],VZ[N]=VZ[NN],dVX[N]=dVX[NN],dVY[N]=dVY[NN],dVZ[N]=dVZ[NN],X[NN]=KX,Y[NN]=KY,Z[NN]=KZ,VX[NN]=KVX,VY[NN]=KVY,VZ[NN]=KVZ,dVX[NN]=KdVX,dVY[NN]=KdVY,dVZ[NN]=KdVZ);L=
sqrt(X[N]*X[N]+Y[N]*Y[N]);L=sqrt(Z[N]*Z[N]+L*L);X[N]+=X[N]*(200-L)/(2*L);Y[N]+=Y[N]*(200-L)/(2*L);Z[N]+=Z[N]*(200-L)/(2*L);KX=X[N]+VX[N];KY=Y[N]+VY[N];KZ=Z[N]+VZ[N];L=sqrt(KX*KX+KY*KY);L=sqrt(KZ*KZ+L*L);VX[N]-=KX*(L-200)/(2*L);VY[N]-=KY*(L-200)/(2*L);VZ[N]-=KZ*(L-200)/(2*L);Z[N]=Z[N]*cos(mouseX*rotate_speed)-X[N]*sin(mouseX*rotate_speed);X[N]=Z[N]*sin(mouseX*rotate_speed)+X[N]*cos(mouseX*rotate_speed);Z[N]=Z[N]*cos(mouseY*rotate_speed)-Y[N]*sin(mouseY*rotate_speed);Y[N]=Z[N]*sin(mouseY*rotate_speed)+
Y[N]*cos(mouseY*rotate_speed);VZ[N]=VZ[N]*cos(mouseX*rotate_speed)-VX[N]*sin(mouseX*rotate_speed);VX[N]=VZ[N]*sin(mouseX*rotate_speed)+VX[N]*cos(mouseX*rotate_speed);VZ[N]=VZ[N]*cos(mouseY*rotate_speed)-VY[N]*sin(mouseY*rotate_speed);VY[N]=VZ[N]*sin(mouseY*rotate_speed)+VY[N]*cos(mouseY*rotate_speed);dVZ[N]=dVZ[N]*cos(mouseX*rotate_speed)-dVX[N]*sin(mouseX*rotate_speed);dVX[N]=dVZ[N]*sin(mouseX*rotate_speed)+dVX[N]*cos(mouseX*rotate_speed);dVZ[N]=dVZ[N]*cos(mouseY*rotate_speed)-dVY[N]*sin(mouseY*
rotate_speed);dVY[N]=dVZ[N]*sin(mouseY*rotate_speed)+dVY[N]*cos(mouseY*rotate_speed);VX[N]+=dVX[N];VY[N]+=dVY[N];VZ[N]+=dVZ[N];L=sqrt(VX[N]*VX[N]+VY[N]*VY[N]);L=sqrt(VZ[N]*VZ[N]+L*L);10<L&&(stroke(255,85+Z[N]/8,62+Z[N]/8,90+Z[N]/5),line((X[N]+VX[N]*(L-12.5)/L)*radius_scale,(Y[N]+VY[N]*(L-12.5)/L)*radius_scale,X[N]*radius_scale,Y[N]*radius_scale))}0!=mouseX||0!=mouseY?first_time=0:first_time&&noLoop()}function checkState(){first_time=0;play_it?(loop(),play_it=0):(noLoop(),play_it=1)};
